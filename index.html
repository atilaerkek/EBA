<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Tablo Sıralama</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }
        .fixed-header {
            position: sticky;
            top: 0;
            background-color: #f0f0f0;
            z-index: 1;
        }
        .sort-button {
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            padding: 5px;
            border: none;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div id="tableContainer"></div>

    <script>
        // Google Sheets'ten veriyi çekme
        fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vRNQRgF1h6eJ7ttqY_ETp8CPieXjjufxfRu1EkOWrgZ1zZW2x2sc8PYgbPqlH2AiUTIj2g6NRbDZVKg/pubhtml')
            .then(response => response.text())
            .then(html => {
                // HTML'den tabloyu çıkarma
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                const table = doc.querySelector('table');
                
                // Yeni tablo oluşturma ve ilk 4 satırı sabit yapma
                const newTable = document.createElement('table');
                const tbody = document.createElement('tbody');
                const rows = Array.from(table.rows);
                
                // İlk 4 satırı sabit olarak ekleme
                for (let i = 0; i < 4; i++) {
                    const row = rows[i].cloneNode(true);
                    row.classList.add('fixed-header');
                    tbody.appendChild(row);
                }

                // Geri kalan satırları ekleme
                const dataRows = rows.slice(4);
                dataRows.forEach(row => tbody.appendChild(row.cloneNode(true)));
                
                newTable.appendChild(tbody);
                document.getElementById('tableContainer').appendChild(newTable);

                // C4 ve T4 hücrelerine sıralama butonları ekleme
                const headerRow = tbody.rows[3];
                const c4Cell = headerRow.cells[2]; // C sütunu (0'dan başlayarak 2)
                const t4Cell = headerRow.cells[19]; // T sütunu (0'dan başlayarak 19)
                
                [c4Cell, t4Cell].forEach(cell => {
                    const button = document.createElement('button');
                    button.textContent = 'Sırala';
                    button.className = 'sort-button';
                    button.onclick = () => sortTable(cell.cellIndex);
                    cell.appendChild(button);
                });
            });

        function sortTable(columnIndex) {
            const table = document.querySelector('table');
            const tbody = table.querySelector('tbody');
            const rows = Array.from(tbody.rows).slice(4); // İlk 4 satırı hariç tut
            
            rows.sort((a, b) => {
                const aValue = a.cells[columnIndex].textContent.trim();
                const bValue = b.cells[columnIndex].textContent.trim();
                
                // Sayısal değerleri kontrol et ve karşılaştır
                const aNum = parseFloat(aValue);
                const bNum = parseFloat(bValue);
                
                if (!isNaN(aNum) && !isNaN(bNum)) {
                    return bNum - aNum; // Büyükten küçüğe
                }
                return bValue.localeCompare(aValue); // Metin için
            });

            // Sıralanmış satırları tabloya geri ekle
            const fixedRows = Array.from(tbody.rows).slice(0, 4);
            while (tbody.firstChild) {
                tbody.removeChild(tbody.firstChild);
            }
            
            // Sabit satırları ve sıralanmış satırları ekle
            fixedRows.concat(rows).forEach(row => tbody.appendChild(row));
        }
    </script>
</body>
</html>
